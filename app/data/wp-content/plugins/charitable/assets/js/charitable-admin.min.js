/*!  1.6.54 2021-11-12 14:30 */

CHARITABLE_ADMIN=window.CHARITABLE_ADMIN||{},function(t,e){e.fn.datepicker&&(t.Datepicker=function(t){this.$el=t;t={dateFormat:this.$el.data("format")||"MM d, yy",minDate:this.$el.data("min-date")||"",beforeShow:function(t,a){e("#ui-datepicker-div").addClass("charitable-datepicker-table")}};this.$el.datepicker(t),this.$el.data("date")&&this.$el.datepicker("setDate",this.$el.data("date")),this.$el.data("min-date")&&this.$el.datepicker("option","minDate",this.$el.data("min-date"))})}(CHARITABLE_ADMIN,jQuery),function(t,o){t.Settings=function(t){var n=[];show_setting=function(t,a){var e="!"===t[0],t=e?t.slice(1):t,t="checked"===t?a.is(":checked"):"selected"===t?a.selected():a.val()===t;return e?!t:t},toggle_setting=function(t,a){var e,n,e=(n=(e=t).parents("tr")).length?n.first():e,t=get_setting_value(t),a=show_setting(t,a);e.toggle(a)},get_setting_value=function(t){var a=t.data("trigger-value");return void 0===a&&(a=t.data("show-only-if-value")),a},toggle_options=function(t,a){var e,n=a.val(),i=t.data("trigger-value");("radio"!==a.attr("type")||a.prop("checked"))&&i.hasOwnProperty(n)&&(e=i[n],t.find("input").each(function(){var t=o(this),a=!(t.val()in e);a&&t.prop("checked",!1),t.prop("disabled",a).trigger("change")}))},get_trigger_id=function(t){var a=t.data("trigger-key");return void 0===a&&(a="#"+t.data("show-only-if-key")),a},get_trigger=function(t){return"#"===t[0]?o(t):o('[name="'+t+'"]')},get_change_type=function(t){t=t.data("trigger-change-type");return void 0===t&&(t="visibility"),t},on_change=function(){var e=o(this);e.data("trigger_idx").forEach(function(t){n[t].settings.forEach(function(t){var a=get_change_type(t);"visibility"===a?toggle_setting(t,e):"options"===a&&toggle_options(t,e)})})},this.$el=t;var e=0;this.$el.find("[data-trigger-key],[data-show-only-if-key]").each(function(){var t=o(this),a=get_trigger_id(t);n[a];void 0===n[a]&&(n[e]={trigger_id:a,settings:[]}),n[e].settings.push(t),e+=1}),n.forEach(function(t,a){var e=get_trigger(t.trigger_id),t=e.data("trigger_idx");void 0===t&&(t=[]),t.push(a),e.data("trigger_idx",t),e.on("change",on_change),e.trigger("change")})}}(CHARITABLE_ADMIN,jQuery),function(c){function s(){var t=c("#campaign_allow_custom_donations"),a=1<(a=c(".charitable-campaign-suggested-donations tbody tr:not(.to-copy)")).length||!1===a.first().hasClass("no-suggested-amounts");t.prop("disabled",!a),a||t.prop("checked",!0)}function t(){var n;c(".charitable-admin-donation-form #donor-id").on("change",function(){var a,e,t=c(this).val();""!==t&&"new"!==t&&((a=c("#charitable-user-fields-wrap")).addClass("loading-data"),data={action:"charitable_get_donor_data",donor_id:t,fields:("object"==typeof n||(n=[],c("#charitable-user-fields-wrap").find("select,input,textarea").each(function(){n.push(this.name)})),n),nonce:c(this).data("nonce")},c.ajax({type:"POST",data:data,dataType:"json",url:ajaxurl,xhrFields:{withCredentials:!0},success:function(t){if(t.success)for(e in t.data)a.find("[name="+e+"]").val(t.data[e]);a.removeClass("loading-data")}}).fail(function(t){window.console&&window.console.log&&(console.log(t),a.removeClass("loading-data"))}))})}function r(){"undefined"!=typeof accounting&&(c("body").on("change",".currency-input",function(){var t,t=(t=c(this).val(),Math.abs(parseFloat(accounting.unformat(t,CHARITABLE.currency_format_decimal_sep))));0<c.trim(t)&&c(this).val((t=t,accounting.formatMoney(t,{symbol:"",decimal:CHARITABLE.currency_format_decimal_sep,thousand:CHARITABLE.currency_format_thousand_sep,precision:CHARITABLE.currency_format_num_decimals,format:CHARITABLE.currency_format}).trim()))}),c(".currency-input").trigger("change"))}var d=function(){c(".charitable-campaign-suggested-donations tbody").each(function(){c(this).children("tr").not(".no-suggested-amounts .to-copy").each(function(a){c(this).data("index",a),c(this).find("input").each(function(t){this.name=this.name.replace(/(\[\d\])/,"["+a+"]")})})})};c(document).ready(function(){var a,e,n,i,o;CHARITABLE_ADMIN.Datepicker&&c(".charitable-datepicker").each(function(){CHARITABLE_ADMIN.Datepicker(c(this))}),c("#charitable-settings, body.post-type-campaign form#post, body.post-type-donation form#post").each(function(){CHARITABLE_ADMIN.Settings(c(this))}),c("body.post-type-campaign .handlediv, body.post-type-donation .handlediv").remove(),c("body.post-type-campaign .hndle, body.post-type-donation .hndle").removeClass("hndle ui-sortable-handle").addClass("postbox-title"),function(){var t=c("#charitable-campaign-advanced-metabox");t.tabs();var a=t.find(".charitable-tabs").height();t.find(".ui-tabs-panel").each(function(){c(this).css("min-height",a)})}(),c(".charitable-campaign-suggested-donations tbody").sortable({items:"tr:not(.to-copy)",handle:".handle",stop:function(t,a){d()}}),s(),c("[data-charitable-action]").on("click",function(t){var a=c(this).data("charitable-args")||{},e="charitable-"+c(this).data("charitable-action");return c.post(ajaxurl,{action:e,data:a},function(t){console.log("Response: "+t)}),!1}),c("[data-charitable-toggle]").on("click",function(t){var a=c(this).data("charitable-toggle"),e=c(this).attr("data-charitable-toggle-text");return e&&e.length&&(c(this).attr("data-charitable-toggle-text",c(this).text()),c(this).text(e)),c("#"+a).toggle(),!1}),(a=c("#charitable_dashboard_donations")).length&&c.ajax({type:"GET",data:{action:"charitable_load_dashboard_donations_widget"},url:ajaxurl,success:function(t){a.find(".inside").html(t)}}),c("#campaign_end_date").on("change",function(){var t=c(this),a=t.val(),e=t.siblings(".charitable-end-time"),t=t.siblings("#campaign_end_time");""!==a&&a?(e.text("@ 23:59 PM").show(),t.val("23:59:59")):(e.hide(),t.val(0))}),(o=c(".charitable-actions-form-wrapper")).length&&(e=o.find(".charitable-action-select"),n=o.find(".charitable-actions-submit"),i=n.find("button"),n.hide(),e.on("change",function(){var a=e.val(),t=e.find("option:selected").data("button-text");""!==a?(o.find(".charitable-action-fields").each(function(){var t=c(this);t.toggle(a===t.data("type"))}),t?i.text(t):i.text(i.prop("title")),n.show()):n.hide()})),c.fn.select2&&c(".select2 select, select.select2").select2(),t(),r(),c("[data-charitable-add-row]").on("click",function(){var t,a;return"suggested-amount"===c(this).data("charitable-add-row")&&(t=c(this),t=(a=t.closest(".charitable-campaign-suggested-donations").find("tbody")).find("tr.to-copy").clone().removeClass("to-copy hidden"),a.find(".no-suggested-amounts").hide(),a.append(t),d(),s()),!1}),c(".charitable-campaign-suggested-donations").on("click",".charitable-delete-row",function(){return console.log("clicked"),function(t){console.log(t),t.closest("tr").remove();t=t.closest(".charitable-campaign-suggested-donations").find("tbody");1==t.find("tr:not(.to-copy)").length&&t.find(".no-suggested-amounts").removeClass("hidden").show(),d(),s()}(c(this)),!1}),c("body").on("click","[data-campaign-benefactor-delete]",function(){var a=c(this).parents(".charitable-benefactor"),t={action:"charitable_delete_benefactor",benefactor_id:c(this).data("campaign-benefactor-delete"),nonce:c(this).data("nonce")};return c.ajax({type:"POST",data:t,dataType:"json",url:ajaxurl,xhrFields:{withCredentials:!0},success:function(t){t.deleted&&a.remove()}}).fail(function(t){window.console&&window.console.log&&(console.log("failture"),console.log(t))}),!1}),c("#change-donation-status").on("change",function(){c(this).parents("form").submit()})})}(jQuery);